<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methodology · TSCSMethods.jl</title><meta name="title" content="Methodology · TSCSMethods.jl"/><meta property="og:title" content="Methodology · TSCSMethods.jl"/><meta property="twitter:title" content="Methodology · TSCSMethods.jl"/><meta name="description" content="Documentation for TSCSMethods.jl."/><meta property="og:description" content="Documentation for TSCSMethods.jl."/><meta property="twitter:description" content="Documentation for TSCSMethods.jl."/><meta property="og:url" content="https://human-nature-lab.github.io/TSCSMethods.jl/methodology/"/><meta property="twitter:url" content="https://human-nature-lab.github.io/TSCSMethods.jl/methodology/"/><link rel="canonical" href="https://human-nature-lab.github.io/TSCSMethods.jl/methodology/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TSCSMethods.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Methodology</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Matching-Framework"><span>The Matching Framework</span></a></li><li><a class="tocitem" href="#Implementation-Details"><span>Implementation Details</span></a></li><li><a class="tocitem" href="#Assumptions"><span>Assumptions</span></a></li><li><a class="tocitem" href="#Extensions"><span>Extensions</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li><li><a class="tocitem" href="../validation/">Validation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Methodology</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Methodology</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/human-nature-lab/TSCSMethods.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/human-nature-lab/TSCSMethods.jl/blob/main/docs/src/methodology.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Methodology"><a class="docs-heading-anchor" href="#Methodology">Methodology</a><a id="Methodology-1"></a><a class="docs-heading-anchor-permalink" href="#Methodology" title="Permalink"></a></h1><p>This page explains the statistical methodology implemented in TSCSMethods.jl.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>TSCSMethods.jl implements the extended matching approach for time-series cross-sectional (TSCS) data developed in Feltham et al. (2023), which builds upon and extends the framework of Imai et al. (2021). This method addresses key challenges in causal inference with panel data:</p><ol><li>Selection bias: Units self-select into treatment</li><li>Time-varying confounding: Confounders change over time</li><li>Temporal correlation: Outcomes are correlated within units over time</li></ol><h2 id="The-Matching-Framework"><a class="docs-heading-anchor" href="#The-Matching-Framework">The Matching Framework</a><a id="The-Matching-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#The-Matching-Framework" title="Permalink"></a></h2><h3 id="Problem-Setup"><a class="docs-heading-anchor" href="#Problem-Setup">Problem Setup</a><a id="Problem-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Setup" title="Permalink"></a></h3><p>Consider panel data with:</p><ul><li>Units: <span>$i = 1, ..., N$</span> (<em>e.g.</em>, counties, countries)</li><li>Time periods: <span>$t = 1, ..., T$</span></li><li>Treatment: <span>$D_{it} \in \{0, 1\}$</span> </li><li>Outcome: <span>$Y_{it}$</span></li><li>Covariates: <span>$X_{it}$</span></li></ul><h3 id="Staggered-Treatment-Design"><a class="docs-heading-anchor" href="#Staggered-Treatment-Design">Staggered Treatment Design</a><a id="Staggered-Treatment-Design-1"></a><a class="docs-heading-anchor-permalink" href="#Staggered-Treatment-Design" title="Permalink"></a></h3><p>TSCSMethods.jl handles <strong>staggered adoption</strong> where units receive treatment at different times:</p><ul><li>Unit <span>$i$</span> receives treatment at time <span>$\tau_i$</span> (the specific day of the event)</li><li><p class="math-container">\[D_{it} = 1\]</p>if <span>$t = \tau_i$</span>, <span>$0$</span> otherwise (treatment occurs only on event day)</li><li>Focus on <strong>event studies</strong>: effects relative to treatment timing</li><li>Supports any discrete events occurring on specific dates</li></ul><h3 id="Matching-Algorithm"><a class="docs-heading-anchor" href="#Matching-Algorithm">Matching Algorithm</a><a id="Matching-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Matching-Algorithm" title="Permalink"></a></h3><p>For each treated unit <span>$i$</span> at time <span>$\tau_i$</span>:</p><ol><li>Define matching window: Pre-treatment periods <span>$L = \{l_1, ..., l_L\}$</span> (negative values)</li><li>Find similar controls: Units <span>$j$</span> with similar <span>$X_{j,\tau_i+l}$</span> for <span>$l \in L$</span></li><li>Calculate distances: <span>$d(i,j) = \sum_{l \in L} w_l ||X_{i,\tau_i+l} - X_{j,\tau_i+l}||$</span></li><li>Select matches: Closest <span>$K$</span> control units for each treated unit</li></ol><h3 id="Balancing"><a class="docs-heading-anchor" href="#Balancing">Balancing</a><a id="Balancing-1"></a><a class="docs-heading-anchor-permalink" href="#Balancing" title="Permalink"></a></h3><p>Assess matching quality by comparing covariate distributions:</p><p class="math-container">\[\text{Balance}_{l,k} = \frac{1}{n_1} \sum_{i \in \text{Treated}} X_{i,\tau_i+l} - \frac{1}{n_0} \sum_{j \in \text{Controls}} X_{j,\tau_i+l}\]</p><p>Good matches have small balance statistics.</p><h3 id="Treatment-Effect-Estimation"><a class="docs-heading-anchor" href="#Treatment-Effect-Estimation">Treatment Effect Estimation</a><a id="Treatment-Effect-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Treatment-Effect-Estimation" title="Permalink"></a></h3><p>Estimate Average Treatment Effect on Treated (ATT) for post-treatment periods <span>$f \in F$</span>:</p><p class="math-container">\[\hat{\tau}_f = \frac{1}{|\text{Treated}|} \sum_{i \in \text{Treated}} \left[ Y_{i,\tau_i+f} - \frac{1}{|M_i|} \sum_{j \in M_i} Y_{j,\tau_i+f} \right]\]</p><p>where <span>$M_i$</span> is the set of matched controls for unit <span>$i$</span>.</p><h3 id="Crossover-Windows-and-Treatment-History"><a class="docs-heading-anchor" href="#Crossover-Windows-and-Treatment-History">Crossover Windows and Treatment History</a><a id="Crossover-Windows-and-Treatment-History-1"></a><a class="docs-heading-anchor-permalink" href="#Crossover-Windows-and-Treatment-History" title="Permalink"></a></h3><p>The method incorporates sophisticated treatment history matching:</p><ul><li>Crossover window: Period examined for treatment history of potential matches</li><li>Pre-treatment crossover: Matches must have similar treatment histories before the focal treatment</li><li>Post-treatment crossover: Control units cannot be treated during specified periods after the focal treatment</li><li>This prevents contamination from other events that might confound the estimates</li></ul><h3 id="Bootstrap-Inference"><a class="docs-heading-anchor" href="#Bootstrap-Inference">Bootstrap Inference</a><a id="Bootstrap-Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrap-Inference" title="Permalink"></a></h3><p>Uncertainty quantification via weighted block-bootstrap:</p><ol><li>Block resampling: Resample entire time series of units to account for within-unit temporal dependence</li><li>Weighted procedure: Account for units being used as matches multiple times</li><li>Re-estimation: Calculate ATT for each of 10,000 bootstrap samples</li><li>Confidence intervals: Derived from 2.5th and 97.5th percentiles of bootstrap distribution</li><li>Bayes factors: Additional evidence quantification using bootstrap distribution parameters</li></ol><h2 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h2><h3 id="Time-Period-Specification"><a class="docs-heading-anchor" href="#Time-Period-Specification">Time Period Specification</a><a id="Time-Period-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Period-Specification" title="Permalink"></a></h3><ul><li>L periods: Pre-treatment periods for matching (negative values)<ul><li>Example: <code>L = -10:-1</code> uses 10 periods before treatment</li></ul></li><li>F periods: Post-treatment periods for estimation (positive values)  <ul><li>Example: <code>F = 1:5</code> estimates effects 1-5 periods after treatment</li></ul></li><li>Reference period: Usually <code>-1</code> (period just before treatment)</li></ul><h3 id="Covariate-Handling"><a class="docs-heading-anchor" href="#Covariate-Handling">Covariate Handling</a><a id="Covariate-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Covariate-Handling" title="Permalink"></a></h3><ul><li>Time-invariant: Unit characteristics that don&#39;t change over the study period<ul><li>Demographics, geography, institutional features</li><li>Any baseline characteristics relevant to the outcome</li></ul></li><li>Time-varying: Variables that change over time during the matching window<ul><li>Outcome history, behavioral indicators, environmental conditions</li><li>Any time-series covariates relevant to treatment assignment and outcomes</li></ul></li><li>Standardization: Covariates standardized using treated unit variance</li><li>Balance assessment: Standardized mean differences maintained ≤ 0.1</li></ul><h3 id="Distance-Metrics"><a class="docs-heading-anchor" href="#Distance-Metrics">Distance Metrics</a><a id="Distance-Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Distance-Metrics" title="Permalink"></a></h3><p>Default uses Mahalanobis distance with temporal averaging:</p><p class="math-container">\[d(i,j) = \frac{1}{L} \sum_{l=1}^{L} \sqrt{(V_{i,t-l} - V_{j,t-l})^T \Sigma_{i,t-l}^{-1} (V_{i,t-l} - V_{j,t-l})}\]</p><p>where:</p><ul><li><p class="math-container">\[V_{i,t-l}\]</p>is the vector of covariates for unit <span>$i$</span> at time <span>$t-l$</span></li><li><p class="math-container">\[\Sigma_{i,t-l}\]</p>is the diagonal covariance matrix</li><li><p class="math-container">\[L = 30\]</p>days is the matching window length</li><li>Distance averaged over the pre-treatment period</li></ul><h2 id="Assumptions"><a class="docs-heading-anchor" href="#Assumptions">Assumptions</a><a id="Assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Assumptions" title="Permalink"></a></h2><p>The method relies on several key assumptions:</p><ol><li>Unconfoundedness: <span>$Y_{it}(0), Y_{it}(1) \perp D_{it} | X_{it}, \text{past}$</span></li><li>Common support: Sufficient overlap in covariate distributions</li><li>No anticipation: Units don&#39;t change behavior before treatment</li><li>SUTVA: No spillover effects between units</li></ol><h2 id="Extensions"><a class="docs-heading-anchor" href="#Extensions">Extensions</a><a id="Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Extensions" title="Permalink"></a></h2><p>TSCSMethods.jl supports several extensions:</p><ul><li>Calipers: Restrict matches to units within distance threshold (balance scores ≤ 0.1)</li><li>Stratification: Separate analysis by subgroups (any categorical or binned continuous variables)</li><li>Multiple outcomes: Analyze several dependent variables simultaneously</li><li>Refinement: Iterative improvement of matches (up to 5 best matches per treated unit)</li><li>Spillover effects: Account for geographic spillover (<em>e.g.</em>, rally attendees from neighboring counties)</li><li>Multiple treatments: Handle units with repeated treatments over time</li></ul><h3 id="Spillover-Effects-Implementation"><a class="docs-heading-anchor" href="#Spillover-Effects-Implementation">Spillover Effects Implementation</a><a id="Spillover-Effects-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Spillover-Effects-Implementation" title="Permalink"></a></h3><p>For events with potential geographic spillover (see Feltham et al. 2023 for a detailed case):</p><ul><li>Direct treatment: County hosts the event</li><li>First degree: Counties adjacent to event location</li><li>Second degree: Counties one step away from event location  </li><li>Third degree: Counties two steps away from event location</li><li>Separate ATT estimation for each exposure level</li></ul><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Feltham, E., Forastiere, L., Alexander, M., &amp; Christakis, N. A. (2023). Mass gatherings for political expression had no discernible association with the local course of the COVID-19 pandemic in the USA in 2020 and 2021. <em>Nature Human Behaviour</em>.</li><li>Imai, K., Kim, I. S., &amp; Wang, E. H. (2021). Matching Methods for Causal Inference with Time-Series Cross-Sectional Data. <em>American Journal of Political Science</em>.</li><li>Rosenbaum, P. R., &amp; Rubin, D. B. (1983). The central role of the propensity score in observational studies for causal effects. <em>Biometrika</em>, 70(1), 41-55.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 19:36">Tuesday 26 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
